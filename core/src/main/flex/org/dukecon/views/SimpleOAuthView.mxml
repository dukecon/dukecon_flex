<?xml version="1.0"?>
<!--
  Created by christoferdutz on 31.08.15.
-->
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark"
        creationComplete="onCreationComplete(event)">

    <fx:Script><![CDATA[
        import mx.events.FlexEvent;

        import org.dukecon.controller.SimpleOAuthController;
        import org.dukecon.events.LoginChangedEvent;

        protected var oauthController:SimpleOAuthController;

        protected function onCreationComplete(event:FlexEvent):void {
            oauthController = SimpleOAuthController.instance;
            oauthController.addEventListener(LoginChangedEvent.USER_LOGGED_IN, onLoginSuccess);
            oauthController.addEventListener(LoginChangedEvent.USER_LOGIN_FAILURE, onLoginFailure);
        }

        protected function onLoginClick(event:MouseEvent):void {
            oauthController.login(usernameInput.text, passwordInput.text);
        }

        protected function onLoginSuccess(event:LoginChangedEvent):void {
            navigator.popView();
        }

        protected function onLoginFailure(event:LoginChangedEvent):void {
            usernameInput.text = "";
            passwordInput.text = "";
        }

        ]]>
    </fx:Script>

    <s:VGroup width="100%" height="100%" horizontalAlign="center">
        <s:Form>
            <s:FormItem label="Username">
                <s:TextInput id="usernameInput" width="100%"/>
            </s:FormItem>
            <s:FormItem label="Password">
                <s:TextInput id="passwordInput" displayAsPassword="true" width="100%"/>
            </s:FormItem>
            <s:FormItem>
                <s:Button label="login" click="onLoginClick(event)"
                          enabled="{usernameInput.text.length > 0 &amp;&amp; passwordInput.text.length > 0}"/>
            </s:FormItem>
        </s:Form>
    </s:VGroup>

</s:View>
